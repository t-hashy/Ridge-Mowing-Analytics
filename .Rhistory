zscore < -1 ~ "一人当たり面積少",
zscore > 1 ~ "一人当たり面積大",
TRUE ~ "ほどほど"
) |>
factor(levels = c("一人当たり面積少", "ほどほど", "一人当たり面積大"))
)
head(data_ridgePerPop2019_cor)
# Visualize
ggplot(data_ridgePerPop2019_map, aes(x = long, y = lat, group = group, fill = value*10000)) +
geom_polygon(linewidth = .5, colour = "#aaaaaa") +
coord_map() +
scale_fill_gradient(low = "#ffffff", high = "#333333") +
facet_wrap(~田畑) +
labs(
title = "都道府県別 農家当たりのけい畔面積（2019年比較）",
subtitle = "※農家人口には「販売農家（経営耕地面積30a以上または農産物販売金額が50万円以上の農家）」の数値を利用。",
caption = "けい畔面積は作物統計調査（農水省）、農家人口は農業構造動態調査（同）より橋本作成",
fill = "農家当たりのけい畔面積（平米）"
) +
theme_void() +
theme(
plot.title = element_text(face = "bold", hjust = .5),
plot.subtitle = element_text(hjust = 1),
strip.background = element_rect(linewidth = 0.5),
axis.title = element_blank()
)
ggplot(data_ridgePerPop2019_cor, aes(x = 販売農家人口, y = 面積, label = 都道府県, colour = cluster)) +
geom_text() +
scale_x_log10(labels = scales::comma) +
scale_y_log10(labels = scales::comma) +
scale_color_manual(values = c("#333333", "#777777", "#333333")) +
facet_wrap(~田畑) +
labs(
title = "都道府県別 けい畔面積と販売農家人口（2019年比較）",
subtitle = "※販売農家（経営耕地面積30a以上または農産物販売金額が50万円以上の農家）",
caption = "けい畔面積は作物統計調査（農水省）、農家人口は農業構造動態調査（同）より橋本作成",
y = "けい畔面積（ha）"
) +
theme_minimal()+
theme(
plot.title = element_text(face = "bold", hjust = .5),
plot.subtitle = element_text(hjust = 1),
strip.background = element_rect(linewidth = 0.5)
)
# Ridge Area Per Yields (2022) ####
# Load the data
data_yields2022_raw <- read.csv("data/生産農業所得統計2022_都道府県別農業産出額及び生産農業所得.csv")
head(data_yields2022_raw)
glimpse(data_yields2022_raw)
# Shape the data
data_yields2022 <- data_yields2022_raw |>
mutate(region = tolower(region)) |>
left_join(filter(data_areaPref, 年次 == 2022)) |>
mutate(
産出額あたりけい畔面積_田 = 田_けい畔_ha/米,
産出額あたりけい畔面積指数_田 = scale(産出額あたりけい畔面積_田),
産出額あたりけい畔面積_畑 = 畑_けい畔_ha/米を除く耕種,
産出額あたりけい畔面積指数_畑 = scale(産出額あたりけい畔面積_畑)
) |>
right_join(map_data, by = "region", relationship = "many-to-many") |>
select(都道府県名, region, starts_with("産出額"), long, lat, group)
head(data_yields2022)
glimpse(data_yields2022)
data_yields2022_gth <- gather(
data_yields2022,
key = "Index",
value = "value",
-c(都道府県名, region, long, lat, group)
) |>
separate(
col = Index,
into = c("Index", "田畑"),
sep = "_"
)
head(data_yields2022_gth)
glimpse(data_yields2022_gth)
# Visualize as a map
ggplot(data_yields2022_gth |> filter(Index == "産出額あたりけい畔面積指数"), aes(x = long, y = lat, group = group, fill = value) )+
geom_polygon(linewidth = .5, colour = "#aaaaaa") +
coord_map() +
scale_fill_gradient(low = "#ffffff", high = "#333333") +
facet_wrap(~田畑) +
labs(
title = "都道府県別 農業産出額あたりのけい畔面積（2022年比較）",
subtitle = "＊農業産出額｜田：米の産出量、畑：米を除く耕種の産出量合計を利用。",
caption = "けい畔面積は作物統計調査（農水省）、農業産出額は生産農業所得統計（同）より橋本作成",
fill = "農業産出額当たりのけい畔面積（標準化済）"
) +
theme_void() +
theme(
plot.title = element_text(face = "bold", hjust = .5),
plot.subtitle = element_text(hjust = 1),
strip.background = element_rect(linewidth = 0.5),
axis.title = element_blank()
)
# Color Plots ####
## Mowing Frequency ####
ggplot(tbl_diary |> filter(草刈り == "草刈りした日"), aes(x = 年月, y = Freq, fill = Freq)) +
geom_col(show.legend = F) +
geom_hline(yintercept = mean_mowingRatio, linetype = "dashed", colour = "#777777") +
geom_text(
aes(x = 4, y = mean_mowingRatio + .01, label = paste0("全期間平均:", scales::percent( mean_mowingRatio)))
) +
scale_y_continuous(labels = scales::percent) +
scale_fill_gradient(low = "#ffffff", high = "#773333")+
labs(
title = "全作業日のうち草刈りをした日の割合",
subtitle = paste0("期間内の作業日数合計:", nrow(data_diary), "日"),
caption = "※橋本の作業日誌から抽出。橋本作業日以外にもほかの人たちで草刈りをした日はあるので、実数とは少しずれている点に注意。",
y = "草刈をした日の割合",
x = ""
) +
theme_classic() +
theme(
plot.title = element_text(face = "bold", hjust = .5),
plot.subtitle = element_text(hjust = 1)
)
## Area Time Series ####
ggplot(data_areaFlow_gthrd |> filter(その他 == "増減率"), aes(x = 年次, y = value, lty = 用途, col = 区分)) +
geom_hline(yintercept = 1, colour = "#777777") +
geom_line(linewidth = 1.2) +
# geom_point(size = 2) +
scale_x_continuous(breaks = seq(from = 1965, to = 2022, by = 5)) +
scale_y_continuous(breaks = seq(from = 0, to = 1.5, by = .1)) +
scale_color_manual(values = c("#aaaaaa", "#337733")) +
facet_wrap(~田畑) +
labs(
title = "1965年を1とした時の耕地面積の増減",
caption = "作物統計調査（農林水産省）より橋本作成"
) +
theme_classic() +
theme(
plot.title = element_text(face = "bold", hjust = .5),
axis.title.y = element_blank()
)
# Ridge Ratio Map ####
ggplot(data_areaPref_2022, aes(x = long, y = lat, group = group, fill = value) ) +
geom_polygon(linewidth = 0.5, colour = "#aaaaaa") +
coord_map() +
scale_fill_gradient(low = "#ffffff", high = "#773333", labels = scales::percent) +
facet_wrap(~田畑) +
labs(
title = "都道府県別けい畔率（2022年比較）",
subtitle = "※けい畔率：本地（作付けできる部分）に対するけい畔の広さ",
caption = "作物統計調査（農水省）より橋本作成",
fill = "けい畔率"
) +
theme_void() +
theme(
plot.title = element_text(face = "bold", hjust = .5),
plot.subtitle = element_text(hjust = 1),
strip.background = element_rect(linewidth = 0.5),
axis.title = element_blank()
)
# Ridge per Pop Map ####
ggplot(data_ridgePerPop2019_map, aes(x = long, y = lat, group = group, fill = value*10000)) +
geom_polygon(linewidth = .5, colour = "#aaaaaa") +
coord_map() +
scale_fill_gradient(low = "#ffffff", high = "#773333") +
facet_wrap(~田畑) +
labs(
title = "都道府県別 農家当たりのけい畔面積（2019年比較）",
subtitle = "※農家人口には「販売農家（経営耕地面積30a以上または農産物販売金額が50万円以上の農家）」の数値を利用。",
caption = "けい畔面積は作物統計調査（農水省）、農家人口は農業構造動態調査（同）より橋本作成",
fill = "農家当たりのけい畔面積（平米）"
) +
theme_void() +
theme(
plot.title = element_text(face = "bold", hjust = .5),
plot.subtitle = element_text(hjust = 1),
strip.background = element_rect(linewidth = 0.5),
axis.title = element_blank()
)
# Get the data
data_pop_raw <- read.csv("data/販売農家人口.csv")
# Visualize
ggplot(data_ridgePerPop2019_map, aes(x = long, y = lat, group = group, fill = value*10000)) +
geom_polygon(linewidth = .5, colour = "#aaaaaa") +
coord_map() +
scale_fill_gradient(low = "#ffffff", high = "#333333") +
facet_wrap(~田畑) +
labs(
title = "都道府県別 農家当たりのけい畔面積（2019年比較）",
subtitle = "※農家人口には「販売農家（経営耕地面積30a以上または農産物販売金額が50万円以上の農家）」の数値を利用。",
caption = "けい畔面積は作物統計調査（農水省）、農家人口は農業構造動態調査（同）より橋本作成",
fill = "農家当たりのけい畔面積（平米）"
) +
theme_void() +
theme(
plot.title = element_text(face = "bold", hjust = .5),
plot.subtitle = element_text(hjust = 1),
strip.background = element_rect(linewidth = 0.5),
axis.title = element_blank()
)
# Visualize only fields
# Visualize
ggplot(data_areaPref_2022 |> filter(田畑 == "畑"), aes(x = long, y = lat, group = group, fill = value) ) +
geom_polygon(linewidth = 0.5, colour = "#aaaaaa") +
coord_map() +
scale_fill_gradient(low = "#ffffff", high = "#333333", labels = scales::percent) +
# facet_wrap(~田畑) +
labs(
title = "都道府県別けい畔率（2022年比較）",
subtitle = "※けい畔率：本地（作付けできる部分）に対するけい畔の広さ",
caption = "作物統計調査（農水省）より橋本作成",
fill = "けい畔率"
) +
theme_void() +
theme(
plot.title = element_text(face = "bold", hjust = .5),
plot.subtitle = element_text(hjust = 1),
strip.background = element_rect(linewidth = 0.5),
axis.title = element_blank()
)
# Visualize only fields
# Visualize
ggplot(data_areaPref_2022 |> filter(田畑 == "畑"), aes(x = long, y = lat, group = group, fill = value) ) +
geom_polygon(linewidth = 0.5, colour = "#aaaaaa") +
coord_map() +
scale_fill_gradient(low = "#ffffff", high = "#333333", labels = scales::percent) +
# facet_wrap(~田畑) +
labs(
title = "都道府県別けい畔率（2022年比較）",
subtitle = "※けい畔率：本地（作付けできる部分）に対するけい畔の広さ",
caption = "作物統計調査（農水省）より橋本作成",
fill = "けい畔率"
) +
theme_void() +
theme(
plot.title = element_text(face = "bold", hjust = .5),
plot.subtitle = element_text(hjust = 0),
strip.background = element_rect(linewidth = 0.5),
axis.title = element_blank()
)
# Visualize only fields
# Visualize
ggplot(data_areaPref_2022 |> filter(田畑 == "畑"), aes(x = long, y = lat, group = group, fill = value) ) +
geom_polygon(linewidth = 0.5, colour = "#aaaaaa") +
coord_map() +
scale_fill_gradient(low = "#ffffff", high = "#333333", labels = scales::percent) +
# facet_wrap(~田畑) +
labs(
title = "都道府県別けい畔率（2022年比較）",
subtitle = "※けい畔率：本地（作付けできる部分）に対するけい畔の広さ",
caption = "作物統計調査（農水省）より橋本作成",
fill = "けい畔率"
) +
theme_void() +
theme(
plot.title = element_text(face = "bold", hjust = .5),
plot.subtitle = element_text(hjust = 0, size = "min"),
strip.background = element_rect(linewidth = 0.5),
axis.title = element_blank()
)
# Visualize only fields
# Visualize
ggplot(data_areaPref_2022 |> filter(田畑 == "畑"), aes(x = long, y = lat, group = group, fill = value) ) +
geom_polygon(linewidth = 0.5, colour = "#aaaaaa") +
coord_map() +
scale_fill_gradient(low = "#ffffff", high = "#333333", labels = scales::percent) +
# facet_wrap(~田畑) +
labs(
title = "都道府県別けい畔率（2022年比較）",
subtitle = "※けい畔率：本地（作付けできる部分）に対するけい畔の広さ",
caption = "作物統計調査（農水省）より橋本作成",
fill = "けい畔率"
) +
theme_void() +
theme(
plot.title = element_text(face = "bold", hjust = .5),
plot.subtitle = element_text(hjust = 0),
strip.background = element_rect(linewidth = 0.5),
axis.title = element_blank()
)
# Visualize only fields
# Visualize
ggplot(data_areaPref_2022 |> filter(田畑 == "畑"), aes(x = long, y = lat, group = group, fill = value) ) +
geom_polygon(linewidth = 0.5, colour = "#aaaaaa") +
coord_map() +
scale_fill_gradient(low = "#ffffff", high = "#333333", labels = scales::percent) +
# facet_wrap(~田畑) +
labs(
title = "都道府県別けい畔率（畑地のみ、2022年比較）",
subtitle = "※けい畔率：本地（作付けできる部分）に対するけい畔の広さ",
caption = "作物統計調査（農水省）より橋本作成",
fill = "けい畔率"
) +
theme_void() +
theme(
plot.title = element_text(face = "bold", hjust = .5),
plot.subtitle = element_text(hjust = 0),
strip.background = element_rect(linewidth = 0.5),
axis.title = element_blank()
)
# Visualize only fields
ggplot(data_ridgePerPop2019_map |> filter(田畑 == "畑"), aes(x = long, y = lat, group = group, fill = value*10000)) +
geom_polygon(linewidth = .5, colour = "#aaaaaa") +
coord_map() +
scale_fill_gradient(low = "#ffffff", high = "#333333") +
# facet_wrap(~田畑) +
labs(
title = "都道府県別 農家当たりのけい畔面積（畑地のみ、2019年比較）",
subtitle = "※農家人口には「販売農家（経営耕地面積30a以上または農産物販売金額が50万円以上の農家）」の数値を利用。",
caption = "けい畔面積は作物統計調査（農水省）、農家人口は農業構造動態調査（同）より橋本作成",
fill = "農家当たりのけい畔面積（平米）"
) +
theme_void() +
theme(
plot.title = element_text(face = "bold", hjust = .5),
plot.subtitle = element_text(hjust = 1),
strip.background = element_rect(linewidth = 0.5),
axis.title = element_blank()
)
# Visualize as a map only with fields
ggplot(data_yields2022_gth |> filter(Index == "産出額あたりけい畔面積指数", 田畑 == "畑"), aes(x = long, y = lat, group = group, fill = value) )+
geom_polygon(linewidth = .5, colour = "#aaaaaa") +
coord_map() +
scale_fill_gradient(low = "#ffffff", high = "#333333") +
facet_wrap(~田畑) +
labs(
title = "都道府県別 農業産出額あたりのけい畔面積（畑地のみ、2022年比較）",
subtitle = "＊農業産出額：米を除く耕種の産出量合計を利用。",
caption = "けい畔面積は作物統計調査（農水省）、農業産出額は生産農業所得統計（同）より橋本作成",
fill = "農業産出額当たりのけい畔面積（標準化済）"
) +
theme_void() +
theme(
plot.title = element_text(face = "bold", hjust = .5),
plot.subtitle = element_text(hjust = 1),
strip.background = element_rect(linewidth = 0.5),
axis.title = element_blank()
)
# Visualize as a map only with fields
ggplot(data_yields2022_gth |> filter(Index == "産出額あたりけい畔面積指数", 田畑 == "畑"), aes(x = long, y = lat, group = group, fill = value) )+
geom_polygon(linewidth = .5, colour = "#aaaaaa") +
coord_map() +
scale_fill_gradient(low = "#ffffff", high = "#333333") +
facet_wrap(~田畑) +
labs(
title = "都道府県別 農業産出額あたりのけい畔面積（畑地のみ、2022年比較）",
subtitle = "＊農業産出額：米を除く耕種の産出量合計を利用。",
caption = "けい畔面積は作物統計調査（農水省）、農業産出額は生産農業所得統計（同）より橋本作成",
fill = "農業産出額当たりのけい畔面積（標準化済）"
) +
theme_void() +
theme(
plot.title = element_text(face = "bold", hjust = .5),
plot.subtitle = element_text(hjust = 1),
strip.background = element_rect(linewidth = 0.5),
axis.title = element_blank(),
legend.position.inside = T
)
# Visualize as a map only with fields
ggplot(data_yields2022_gth |> filter(Index == "産出額あたりけい畔面積指数", 田畑 == "畑"), aes(x = long, y = lat, group = group, fill = value) )+
geom_polygon(linewidth = .5, colour = "#aaaaaa") +
coord_map() +
scale_fill_gradient(low = "#ffffff", high = "#333333") +
facet_wrap(~田畑) +
labs(
title = "都道府県別 農業産出額あたりのけい畔面積（畑地のみ、2022年比較）",
subtitle = "＊農業産出額：米を除く耕種の産出量合計を利用。",
caption = "けい畔面積は作物統計調査（農水省）、農業産出額は生産農業所得統計（同）より橋本作成",
fill = "農業産出額当たりのけい畔面積（標準化済）"
) +
theme_void() +
theme(
plot.title = element_text(face = "bold", hjust = .5),
plot.subtitle = element_text(hjust = 1),
strip.background = element_rect(linewidth = 0.5),
axis.title = element_blank(),
legend.position.inside = 1
)
# Visualize as a map only with fields
ggplot(data_yields2022_gth |> filter(Index == "産出額あたりけい畔面積指数", 田畑 == "畑"), aes(x = long, y = lat, group = group, fill = value) )+
geom_polygon(linewidth = .5, colour = "#aaaaaa") +
coord_map() +
scale_fill_gradient(low = "#ffffff", high = "#333333") +
facet_wrap(~田畑) +
labs(
title = "都道府県別 農業産出額あたりのけい畔面積（畑地のみ、2022年比較）",
subtitle = "＊農業産出額：米を除く耕種の産出量合計を利用。",
caption = "けい畔面積は作物統計調査（農水省）、農業産出額は生産農業所得統計（同）より橋本作成",
fill = "農業産出額当たりのけい畔面積（標準化済）"
) +
theme_void() +
theme(
plot.title = element_text(face = "bold", hjust = .5),
plot.subtitle = element_text(hjust = 1),
strip.background = element_rect(linewidth = 0.5),
axis.title = element_blank(),
legend.position.inside = 0
)
# Visualize as a map only with fields
ggplot(data_yields2022_gth |> filter(Index == "産出額あたりけい畔面積指数", 田畑 == "畑"), aes(x = long, y = lat, group = group, fill = value) )+
geom_polygon(linewidth = .5, colour = "#aaaaaa") +
coord_map() +
scale_fill_gradient(low = "#ffffff", high = "#333333") +
facet_wrap(~田畑) +
labs(
title = "都道府県別 農業産出額あたりのけい畔面積（畑地のみ、2022年比較）",
subtitle = "＊農業産出額：米を除く耕種の産出量合計を利用。",
caption = "けい畔面積は作物統計調査（農水省）、農業産出額は生産農業所得統計（同）より橋本作成",
fill = "農業産出額当たりのけい畔面積（標準化済）"
) +
theme_void() +
theme(
plot.title = element_text(face = "bold", hjust = .5),
plot.subtitle = element_text(hjust = 1),
strip.background = element_rect(linewidth = 0.5),
axis.title = element_blank(),
legend.position = "inside"
)
# Visualize as a map only with fields
ggplot(data_yields2022_gth |> filter(Index == "産出額あたりけい畔面積指数", 田畑 == "畑"), aes(x = long, y = lat, group = group, fill = value) )+
geom_polygon(linewidth = .5, colour = "#aaaaaa") +
coord_map() +
scale_fill_gradient(low = "#ffffff", high = "#333333") +
facet_wrap(~田畑) +
labs(
title = "都道府県別 農業産出額あたりのけい畔面積（畑地のみ、2022年比較）",
subtitle = "＊農業産出額：米を除く耕種の産出量合計を利用。",
caption = "けい畔面積は作物統計調査（農水省）、農業産出額は生産農業所得統計（同）より橋本作成",
fill = "農業産出額当たりのけい畔面積（標準化済）"
) +
theme_void() +
theme(
plot.title = element_text(face = "bold", hjust = .5),
plot.subtitle = element_text(hjust = 1),
strip.background = element_rect(linewidth = 0.5),
axis.title = element_blank(),
legend.position = "bottom"
)
# Visualize as a map only with fields
ggplot(data_yields2022_gth |> filter(Index == "産出額あたりけい畔面積指数", 田畑 == "畑"), aes(x = long, y = lat, group = group, fill = value) )+
geom_polygon(linewidth = .5, colour = "#aaaaaa") +
coord_map() +
scale_fill_gradient(low = "#ffffff", high = "#333333") +
# facet_wrap(~田畑) +
labs(
title = "都道府県別 農業産出額あたりのけい畔面積（畑地のみ、2022年比較）",
subtitle = "＊農業産出額：米を除く耕種の産出量合計を利用。",
caption = "けい畔面積は作物統計調査（農水省）、農業産出額は生産農業所得統計（同）より橋本作成",
fill = "農業産出額当たりのけい畔面積（標準化済）"
) +
theme_void() +
theme(
plot.title = element_text(face = "bold", hjust = .5),
plot.subtitle = element_text(hjust = 1),
strip.background = element_rect(linewidth = 0.5),
axis.title = element_blank(),
legend.position = "bottom"
)
# Visualize as a map only with fields
ggplot(data_yields2022_gth |> filter(Index == "産出額あたりけい畔面積指数", 田畑 == "畑"), aes(x = long, y = lat, group = group, fill = value) )+
geom_polygon(linewidth = .5, colour = "#aaaaaa") +
coord_map() +
scale_fill_gradient(low = "#ffffff", high = "#333333") +
# facet_wrap(~田畑) +ぇ
labs(
title = "都道府県別 農業産出額あたりのけい畔面積（畑地のみ、2022年比較）",
subtitle = "＊農業産出額：米を除く耕種の産出量合計を利用。",
caption = "けい畔面積は作物統計調査（農水省）、農業産出額は生産農業所得統計（同）より橋本作成",
fill = "農業産出額当たりのけい畔面積（標準化済）"
) +
theme_void() +
theme(
plot.title = element_text(face = "bold", hjust = .5),
plot.subtitle = element_text(hjust = 1),
strip.background = element_rect(linewidth = 0.5),
axis.title = element_blank(),
# legend.position = "bottom"
)
# Visualize as a map only with fields
ggplot(data_yields2022_gth |> filter(Index == "産出額あたりけい畔面積指数", 田畑 == "畑"), aes(x = long, y = lat, group = group, fill = value) )+
geom_polygon(linewidth = .5, colour = "#aaaaaa") +
coord_map() +
scale_fill_gradient(low = "#ffffff", high = "#333333") +
# facet_wrap(~田畑) +ぇ
labs(
title = "都道府県別 農業産出額あたりのけい畔面積（畑地のみ、2022年比較）",
subtitle = "＊農業産出額：米を除く耕種の産出量合計を利用。",
caption = "けい畔面積は作物統計調査（農水省）、農業産出額は生産農業所得統計（同）より橋本作成",
fill = "農業産出額当たりのけい畔面積（標準化済）"
) +
theme_void() +
theme(
plot.title = element_text(face = "bold", hjust = .5),
plot.subtitle = element_text(hjust = 1),
strip.background = element_rect(linewidth = 0.5),
axis.title = element_blank(),
legend.position = "none"
)
# Visualize as a map only with fields
ggplot(data_yields2022_gth |> filter(Index == "産出額あたりけい畔面積指数", 田畑 == "畑"), aes(x = long, y = lat, group = group, fill = value) )+
geom_polygon(linewidth = .5, colour = "#aaaaaa") +
coord_map() +
scale_fill_gradient(low = "#ffffff", high = "#333333") +
# facet_wrap(~田畑) +ぇ
labs(
title = "都道府県別 農業産出額あたりのけい畔面積（畑地のみ、2022年比較）",
subtitle = "＊農業産出額：米を除く耕種の産出量合計を利用。",
caption = "けい畔面積は作物統計調査（農水省）、農業産出額は生産農業所得統計（同）より橋本作成",
fill = "標準化済指数"
) +
theme_void() +
theme(
plot.title = element_text(face = "bold", hjust = .5),
plot.subtitle = element_text(hjust = 1),
strip.background = element_rect(linewidth = 0.5),
axis.title = element_blank(),
# legend.position = "bottom"
)
